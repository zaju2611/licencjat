"use strict";var _firebaseApp=require("https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"),_firebaseDatabase=require("https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"),canvas=document.querySelector(".canvas"),ctx=canvas.getContext("2d",{willReadFrequently:!0}),taskContent=document.querySelector(".content"),answerCard=document.querySelector(".mainDraw_container-cards-container-answer-board"),checkAnswer=document.querySelector(".check-answer"),result=document.querySelector(".result"),goodBtn=document.querySelector(".good-answer"),badBtn=document.querySelector(".wrong-answer"),startBtn=document.querySelector(".start-play"),answerBtns=document.querySelectorAll(".button-answer"),clearCanvas=document.querySelector(".clear-canvas"),drawingCard=document.querySelector(".mainDraw_container-cards-container-drawing-board"),resultPopup=document.querySelector(".resultPopup"),urlParams=new URLSearchParams(window.location.search),gameType=urlParams.get("game"),arr=[],points=0,index=0,app=(0,_firebaseApp.initializeApp)(firebaseConfig),database=(0,_firebaseDatabase.getDatabase)(app);function setBackground(e){var a=new Image,t=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(t,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),a.src=e.z):console.log("no data available")}).catch(function(e){console.error(e)}),a.addEventListener("load",function(){ctx.drawImage(a,0,0,canvas.width,canvas.height)})}function setTaskContent(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),taskContent.textContent=e.t):console.log("no data available")}).catch(function(e){console.error(e)})}function setAnswer(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),answerCard.style.backgroundImage="url('".concat(e.o,"')"),answerCard.style.backgroundSize="contain"):console.log("no data available")}).catch(function(e){console.error(e)})}function addPoint(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),points+=e.p,result.textContent=points):console.log("no data available")}).catch(function(e){console.error(e)}),result.classList.add("addPoint"),setTimeout(function(){result.classList.remove("addPoint")},1e3)}function removePoint(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),points-=e.p,result.textContent=points):console.log("no data available")}).catch(function(e){console.error(e)}),result.classList.add("removePoint"),setTimeout(function(){result.classList.remove("removePoint")},1e3)}function setData(e){setBackground(e),setTaskContent(e),setAnswer(e)}function removeAnswerCards(){answerCard.classList.remove("a-active"),drawingCard.classList.remove("d-active"),answerBtns.forEach(function(e){e.classList.remove("b-active")})}var randUniqueNumber=function(e,a){return Math.floor(Math.random()*(a-e+1))+e},fetchData=function(e){"flat"===e?index=randUniqueNumber(1,14):"spatial"===e?index=randUniqueNumber(15,18):"mix"===e&&(index=randUniqueNumber(1,18)),console.log(index)};function getRandomUniqueNumber(e){for(fetchData(gameType);e.includes(index);)fetchData(gameType);return e.push(index),index}clearCanvas.addEventListener("click",function(){setData(index)}),startBtn.addEventListener("click",function(){fetchData(gameType),setData(index),arr.push(index),clearCanvas.disabled=!1,checkAnswer.disabled=!1,startBtn.disabled=!0}),goodBtn.addEventListener("click",function(){addPoint(index),index=getRandomUniqueNumber(arr),console.log(index),setData(index),removeAnswerCards()}),badBtn.addEventListener("click",function(){removePoint(index),setData(index=getRandomUniqueNumber(arr)),removeAnswerCards()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZldGNoRGF0YS5qcyJdLCJuYW1lcyI6WyJfZmlyZWJhc2VBcHAiLCJyZXF1aXJlIiwiX2ZpcmViYXNlRGF0YWJhc2UiLCJjYW52YXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjdHgiLCJnZXRDb250ZXh0Iiwid2lsbFJlYWRGcmVxdWVudGx5IiwidGFza0NvbnRlbnQiLCJhbnN3ZXJDYXJkIiwicmVzdWx0IiwiY2hlY2tBbnN3ZXIiLCJnb29kQnRuIiwiYmFkQnRuIiwiY2xlYXJDYW52YXMiLCJkcmF3aW5nQ2FyZCIsImxvY2F0aW9uIiwic2VhcmNoIiwicmVzdWx0UG9wdXAiLCJ1cmxQYXJhbXMiLCJnYW1lVHlwZSIsImFyciIsInBvaW50cyIsImJhY2tncm91bmRJbWFnZSIsImZpcmViYXNlQ29uZmlnIiwiY29uc29sZSIsImdldERhdGFiYXNlIiwiYXBwIiwic2V0QmFja2dyb3VuZCIsImluZGV4IiwiSW1hZ2UiLCJkYXRhUmVmIiwicmVmIiwiZ2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRoZW4iLCJkcmF3SW1hZ2UiLCJzbmFwc2hvdCIsImV4aXN0cyIsImRhdGEiLCJ2YWwiLCJzZXRUYXNrQ29udGVudCIsInoiLCJjaGlsZCIsImVycm9yIiwid2lkdGgiLCJoZWlnaHQiLCJzdHlsZSIsImJhY2tncm91bmRTaXplIiwidGV4dENvbnRlbnQiLCJ0IiwibG9nIiwiY29uY2F0IiwibyIsInNldFRpbWVvdXQiLCJwIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2V0QW5zd2VyIiwiYW5zd2VyQnRucyIsImZvckVhY2giLCJlbGVtZW50IiwicmFuZFVuaXF1ZU51bWJlciIsIk1hdGgiLCJpbmNsdWRlcyIsInN0YXJ0QnRuIiwiZmV0Y2hEYXRhIiwic2V0RGF0YSIsIm1pbiIsIm1heCIsImRpc2FibGVkIiwiZmxvb3IiLCJyYW5kb20iLCJnZXRSYW5kb21VbmlxdWVOdW1iZXIiLCJyZW1vdmVBbnN3ZXJDYXJkcyIsInJlbW92ZVBvaW50IiwicHVz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dUQsS0FBSy9DLEtBQUssRUFDZGYsWUFBWXdELFNBQVcsQ0FBQSxFQUN2QjNELFlBQVkyRCxTQUFXLENBQUEsRUFDdkJMLFNBQVNLLFNBQVcsQ0FBQSxDQUNyQixDQUFDLEVBRUQxRCxRQUFRc0IsaUJBQWlCLFFBQVMsV0FDakMyQyxTQUFTaEQsS0FBSyxFQUNkQSxNQUFRNEMsc0JBQXNCcEQsR0FBRyxFQUNqQ0ksUUFBUTBCLElBQUl0QixLQUFLLEVBQ2pCc0MsUUFBUXRDLEtBQUssRUFDYjZDLGtCQUFpQixDQUNsQixDQUFDLEVBRUQ3RCxPQUFPcUIsaUJBQWlCLFFBQVMsV0FDaEN5QyxZQUFZOUMsS0FBSyxFQUVqQnNDLFFBREF0QyxNQUFRNEMsc0JBQXNCcEQsR0FBRyxDQUNwQixFQUNicUQsa0JBQWlCLENBQ2xCLENBQUMiLCJmaWxlIjoiZmV0Y2hEYXRhLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYW52YXNcIik7XHJcbmNvbnN0IGN0eCA9IGNhbnZhcy5nZXRDb250ZXh0KFwiMmRcIiwgeyB3aWxsUmVhZEZyZXF1ZW50bHk6IHRydWUgfSk7XHJcbmNvbnN0IHRhc2tDb250ZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb250ZW50XCIpO1xyXG5jb25zdCBhbnN3ZXJDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHRcIi5tYWluRHJhd19jb250YWluZXItY2FyZHMtY29udGFpbmVyLWFuc3dlci1ib2FyZFwiXHJcbik7XHJcbmNvbnN0IGNoZWNrQW5zd2VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jaGVjay1hbnN3ZXJcIik7XHJcbmNvbnN0IHJlc3VsdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmVzdWx0XCIpO1xyXG5jb25zdCBnb29kQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nb29kLWFuc3dlclwiKTtcclxuY29uc3QgYmFkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi53cm9uZy1hbnN3ZXJcIik7XHJcbmNvbnN0IHN0YXJ0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5zdGFydC1wbGF5XCIpO1xyXG5jb25zdCBhbnN3ZXJCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5idXR0b24tYW5zd2VyXCIpO1xyXG5jb25zdCBjbGVhckNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2xlYXItY2FudmFzXCIpO1xyXG5jb25zdCBkcmF3aW5nQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XCIubWFpbkRyYXdfY29udGFpbmVyLWNhcmRzLWNvbnRhaW5lci1kcmF3aW5nLWJvYXJkXCJcclxuKTtcclxuY29uc3QgcmVzdWx0UG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc3VsdFBvcHVwXCIpO1xyXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG5jb25zdCBnYW1lVHlwZSA9IHVybFBhcmFtcy5nZXQoXCJnYW1lXCIpO1xyXG5cclxuY29uc3QgYXJyID0gW107XHJcbmxldCBwb2ludHMgPSAwO1xyXG5sZXQgaW5kZXggPSAwO1xyXG5cclxuaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJodHRwczovL3d3dy5nc3RhdGljLmNvbS9maXJlYmFzZWpzLzkuMTcuMS9maXJlYmFzZS1hcHAuanNcIjtcclxuaW1wb3J0IHtcclxuXHRnZXREYXRhYmFzZSxcclxuXHRyZWYsXHJcblx0Y2hpbGQsXHJcblx0Z2V0LFxyXG59IGZyb20gXCJodHRwczovL3d3dy5nc3RhdGljLmNvbS9maXJlYmFzZWpzLzkuMTcuMS9maXJlYmFzZS1kYXRhYmFzZS5qc1wiO1xyXG5cclxuY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7XHJcblxyXG5jb25zdCBkYXRhYmFzZSA9IGdldERhdGFiYXNlKGFwcCk7XHJcblxyXG5mdW5jdGlvbiBzZXRCYWNrZ3JvdW5kKGluZGV4KSB7XHJcblx0Y29uc3QgYmFja2dyb3VuZEltYWdlID0gbmV3IEltYWdlKCk7XHJcblx0Y29uc3QgZGF0YVJlZiA9IHJlZihnZXREYXRhYmFzZSgpKTtcclxuXHRnZXQoY2hpbGQoZGF0YVJlZiwgYGV4ZXJjaXNlLyR7aW5kZXh9YCkpXHJcblx0XHQudGhlbigoc25hcHNob3QpID0+IHtcclxuXHRcdFx0aWYgKHNuYXBzaG90LmV4aXN0cygpKSB7XHJcblx0XHRcdFx0Y29uc3QgZGF0YSA9IHNuYXBzaG90LnZhbCgpO1xyXG5cdFx0XHRcdGJhY2tncm91bmRJbWFnZS5zcmMgPSBkYXRhLno7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJubyBkYXRhIGF2YWlsYWJsZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHRcdC5jYXRjaCgoZXJyb3IpID0+IHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihlcnJvcik7XHJcblx0XHR9KTtcclxuXHJcblx0YmFja2dyb3VuZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcclxuXHRcdGN0eC5kcmF3SW1hZ2UoYmFja2dyb3VuZEltYWdlLCAwLCAwLCBjYW52YXMud2lkdGgsIGNhbnZhcy5oZWlnaHQpO1xyXG5cdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRUYXNrQ29udGVudChpbmRleCkge1xyXG5cdGNvbnN0IGRhdGFSZWYgPSByZWYoZ2V0RGF0YWJhc2UoKSk7XHJcblx0Z2V0KGNoaWxkKGRhdGFSZWYsIGBleGVyY2lzZS8ke2luZGV4fWApKVxyXG5cdFx0LnRoZW4oKHNuYXBzaG90KSA9PiB7XHJcblx0XHRcdGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBzbmFwc2hvdC52YWwoKTtcclxuXHRcdFx0XHR0YXNrQ29udGVudC50ZXh0Q29udGVudCA9IGRhdGEudDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIm5vIGRhdGEgYXZhaWxhYmxlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKChlcnJvcikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcclxuXHRcdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRBbnN3ZXIoaW5kZXgpIHtcclxuXHRjb25zdCBkYXRhUmVmID0gcmVmKGdldERhdGFiYXNlKCkpO1xyXG5cdGdldChjaGlsZChkYXRhUmVmLCBgZXhlcmNpc2UvJHtpbmRleH1gKSlcclxuXHRcdC50aGVuKChzbmFwc2hvdCkgPT4ge1xyXG5cdFx0XHRpZiAoc25hcHNob3QuZXhpc3RzKCkpIHtcclxuXHRcdFx0XHRjb25zdCBkYXRhID0gc25hcHNob3QudmFsKCk7XHJcblx0XHRcdFx0YW5zd2VyQ2FyZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCcke2RhdGEub30nKWA7XHJcblx0XHRcdFx0YW5zd2VyQ2FyZC5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9IFwiY29udGFpblwiO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFBvaW50KGluZGV4KSB7XHJcblx0Y29uc3QgZGF0YVJlZiA9IHJlZihnZXREYXRhYmFzZSgpKTtcclxuXHRnZXQoY2hpbGQoZGF0YVJlZiwgYGV4ZXJjaXNlLyR7aW5kZXh9YCkpXHJcblx0XHQudGhlbigoc25hcHNob3QpID0+IHtcclxuXHRcdFx0aWYgKHNuYXBzaG90LmV4aXN0cygpKSB7XHJcblx0XHRcdFx0Y29uc3QgZGF0YSA9IHNuYXBzaG90LnZhbCgpO1xyXG5cdFx0XHRcdHBvaW50cyArPSBkYXRhLnA7XHJcblx0XHRcdFx0cmVzdWx0LnRleHRDb250ZW50ID0gcG9pbnRzO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcblxyXG5cdHJlc3VsdC5jbGFzc0xpc3QuYWRkKFwiYWRkUG9pbnRcIik7XHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRyZXN1bHQuY2xhc3NMaXN0LnJlbW92ZShcImFkZFBvaW50XCIpO1xyXG5cdH0sIDEwMDApO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVQb2ludChpbmRleCkge1xyXG5cdGNvbnN0IGRhdGFSZWYgPSByZWYoZ2V0RGF0YWJhc2UoKSk7XHJcblx0Z2V0KGNoaWxkKGRhdGFSZWYsIGBleGVyY2lzZS8ke2luZGV4fWApKVxyXG5cdFx0LnRoZW4oKHNuYXBzaG90KSA9PiB7XHJcblx0XHRcdGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBzbmFwc2hvdC52YWwoKTtcclxuXHRcdFx0XHRwb2ludHMgLT0gZGF0YS5wO1xyXG5cdFx0XHRcdHJlc3VsdC50ZXh0Q29udGVudCA9IHBvaW50cztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIm5vIGRhdGEgYXZhaWxhYmxlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKChlcnJvcikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcclxuXHRcdH0pO1xyXG5cclxuXHRyZXN1bHQuY2xhc3NMaXN0LmFkZChcInJlbW92ZVBvaW50XCIpO1xyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0cmVzdWx0LmNsYXNzTGlzdC5yZW1vdmUoXCJyZW1vdmVQb2ludFwiKTtcclxuXHR9LCAxMDAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0RGF0YShpbmRleCkge1xyXG5cdHNldEJhY2tncm91bmQoaW5kZXgpO1xyXG5cdHNldFRhc2tDb250ZW50KGluZGV4KTtcclxuXHRzZXRBbnN3ZXIoaW5kZXgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVBbnN3ZXJDYXJkcygpIHtcclxuXHRhbnN3ZXJDYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJhLWFjdGl2ZVwiKTtcclxuXHRkcmF3aW5nQ2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiZC1hY3RpdmVcIik7XHJcblx0YW5zd2VyQnRucy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJiLWFjdGl2ZVwiKTtcclxuXHR9KTtcclxufVxyXG5cclxuY29uc3QgcmFuZFVuaXF1ZU51bWJlciA9IChtaW4sIG1heCkgPT4ge1xyXG5cdGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcclxuXHRyZXR1cm4gaW5kZXg7XHJcbn07XHJcblxyXG5jb25zdCBmZXRjaERhdGEgPSAoZ2FtZVR5cGUpID0+IHtcclxuXHRpZiAoZ2FtZVR5cGUgPT09IFwiZmxhdFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMSwgMTQpO1xyXG5cdH0gZWxzZSBpZiAoZ2FtZVR5cGUgPT09IFwic3BhdGlhbFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMTUsIDE4KTtcclxuXHR9IGVsc2UgaWYgKGdhbWVUeXBlID09PSBcIm1peFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMSwgMTgpO1xyXG5cdH1cclxuXHRjb25zb2xlLmxvZyhpbmRleCk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBnZXRSYW5kb21VbmlxdWVOdW1iZXIoYXJyKSB7XHJcblx0ZmV0Y2hEYXRhKGdhbWVUeXBlKTtcclxuXHR3aGlsZSAoYXJyLmluY2x1ZGVzKGluZGV4KSkge1xyXG5cdFx0ZmV0Y2hEYXRhKGdhbWVUeXBlKTtcclxuXHR9XHJcblx0YXJyLnB1c2goaW5kZXgpO1xyXG5cdHJldHVybiBpbmRleDtcclxufVxyXG5cclxuY2xlYXJDYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuXHRzZXREYXRhKGluZGV4KTtcclxufSk7XHJcblxyXG5zdGFydEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG5cdGZldGNoRGF0YShnYW1lVHlwZSk7XHJcblx0c2V0RGF0YShpbmRleCk7XHJcblx0YXJyLnB1c2goaW5kZXgpO1xyXG5cdGNsZWFyQ2FudmFzLmRpc2FibGVkID0gZmFsc2U7XHJcblx0Y2hlY2tBbnN3ZXIuZGlzYWJsZWQgPSBmYWxzZTtcclxuXHRzdGFydEJ0bi5kaXNhYmxlZCA9IHRydWU7XHJcbn0pO1xyXG5cclxuZ29vZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG5cdGFkZFBvaW50KGluZGV4KTtcclxuXHRpbmRleCA9IGdldFJhbmRvbVVuaXF1ZU51bWJlcihhcnIpO1xyXG5cdGNvbnNvbGUubG9nKGluZGV4KTtcclxuXHRzZXREYXRhKGluZGV4KTtcclxuXHRyZW1vdmVBbnN3ZXJDYXJkcygpO1xyXG59KTtcclxuXHJcbmJhZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG5cdHJlbW92ZVBvaW50KGluZGV4KTtcclxuXHRpbmRleCA9IGdldFJhbmRvbVVuaXF1ZU51bWJlcihhcnIpO1xyXG5cdHNldERhdGEoaW5kZXgpO1xyXG5cdHJlbW92ZUFuc3dlckNhcmRzKCk7XHJcbn0pO1xyXG4iXX0=
