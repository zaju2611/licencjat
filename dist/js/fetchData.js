"use strict";var _firebaseApp=require("https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"),_firebaseDatabase=require("https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"),canvas=document.querySelector(".canvas"),ctx=canvas.getContext("2d",{willReadFrequently:!0}),taskContent=document.querySelector(".content"),answerCard=document.querySelector(".mainDraw_container-cards-container-answer-board"),checkAnswer=document.querySelector(".check-answer"),result=document.querySelector(".result"),goodBtn=document.querySelector(".good-answer"),badBtn=document.querySelector(".wrong-answer"),startBtn=document.querySelector(".start-play"),answerBtns=document.querySelectorAll(".button-answer"),clearCanvas=document.querySelector(".clear-canvas"),drawingCard=document.querySelector(".mainDraw_container-cards-container-drawing-board"),resultPopup=document.querySelector(".resultPopup"),urlParams=new URLSearchParams(window.location.search),gameType=urlParams.get("game"),arr=[],points=0,index=0,app=(0,_firebaseApp.initializeApp)(firebaseConfig),database=(0,_firebaseDatabase.getDatabase)(app);function setBackground(e){var a=new Image,t=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(t,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),a.src=e.z):console.log("no data available")}).catch(function(e){console.error(e)}),a.addEventListener("load",function(){ctx.drawImage(a,0,0,canvas.width,canvas.height)})}function setTaskContent(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),taskContent.textContent=e.t):console.log("no data available")}).catch(function(e){console.error(e)})}function setAnswer(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),answerCard.style.backgroundImage="url('".concat(e.o,"')"),answerCard.style.backgroundSize="contain",answerCard.style.backgroundPosition="center"):console.log("no data available")}).catch(function(e){console.error(e)})}function addPoint(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),points+=e.p,result.textContent=points):console.log("no data available")}).catch(function(e){console.error(e)}),result.classList.add("addPoint"),setTimeout(function(){result.classList.remove("addPoint")},1e3)}function removePoint(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),points-=e.p,result.textContent=points):console.log("no data available")}).catch(function(e){console.error(e)}),result.classList.add("removePoint"),setTimeout(function(){result.classList.remove("removePoint")},1e3)}function setData(e){setBackground(e),setTaskContent(e),setAnswer(e)}function removeAnswerCards(){answerCard.classList.remove("a-active"),drawingCard.classList.remove("d-active"),answerBtns.forEach(function(e){e.classList.remove("b-active")})}var randUniqueNumber=function(e,a){return Math.floor(Math.random()*(a-e+1))+e},fetchData=function(e){"flat"===e?index=randUniqueNumber(1,16):"spatial"===e?index=randUniqueNumber(22,160):"mix"===e&&(index=randUniqueNumber(100,160)),console.log(index)};function getRandomUniqueNumber(e){for(fetchData(gameType);e.includes(index);)fetchData(gameType);return e.push(index),index}clearCanvas.addEventListener("click",function(){setData(index)}),startBtn.addEventListener("click",function(){fetchData(gameType),setData(index),arr.push(index),clearCanvas.disabled=!1,checkAnswer.disabled=!1,startBtn.disabled=!0}),goodBtn.addEventListener("click",function(){addPoint(index),index=getRandomUniqueNumber(arr),console.log(index),setData(index),removeAnswerCards()}),badBtn.addEventListener("click",function(){removePoint(index),setData(index=getRandomUniqueNumber(arr)),removeAnswerCards()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZldGNoRGF0YS5qcyJdLCJuYW1lcyI6WyJfZmlyZWJhc2VBcHAiLCJyZXF1aXJlIiwiX2ZpcmViYXNlRGF0YWJhc2UiLCJjYW52YXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjdHgiLCJnZXRDb250ZXh0Iiwid2lsbFJlYWRGcmVxdWVudGx5IiwidGFza0NvbnRlbnQiLCJhbnN3ZXJDYXJkIiwicmVzdWx0IiwiY2hlY2tBbnN3ZXIiLCJnb29kQnRuIiwiYmFkQnRuIiwiY2xlYXJDYW52YXMiLCJkcmF3aW5nQ2FyZCIsImxvY2F0aW9uIiwic2VhcmNoIiwicmVzdWx0UG9wdXAiLCJ1cmxQYXJhbXMiLCJnYW1lVHlwZSIsImFyciIsInBvaW50cyIsImJhY2tncm91bmRJbWFnZSIsImZpcmViYXNlQ29uZmlnIiwiY29uc29sZSIsImdldERhdGFiYXNlIiwiYXBwIiwic2V0QmFja2dyb3VuZCIsImluZGV4IiwiSW1hZ2UiLCJkYXRhUmVmIiwicmVmIiwiZ2V0IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRoZW4iLCJkcmF3SW1hZ2UiLCJzbmFwc2hvdCIsImV4aXN0cyIsImRhdGEiLCJ2YWwiLCJzZXRUYXNrQ29udGVudCIsInoiLCJjaGlsZCIsImVycm9yIiwid2lkdGgiLCJoZWlnaHQiLCJzdHlsZSIsImJhY2tncm91bmRTaXplIiwidGV4dENvbnRlbnQiLCJiYWNrZ3JvdW5kUG9zaXRpb24iLCJsb2ciLCJjb25jYXQiLCJvIiwic2V0VGltZW91dCIsInAiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJzZXRBbnN3ZXIiLCJhbnN3ZXJCdG5zIiwiZm9yRWFjaCIsImVsZW1lbnQiLCJyYW5kVW5pcXVlTnVtYmVyIiwiTWF0aCIsImluY2x1ZGVzIiwic3RhcnRCdG4iLCJmZXRjaERhdGEiLCJzZXREYXRhIiwibWluIiwibWF4IiwiZGlzYWJsZWQiLCJmbG9vciIsInJhbmRvbSIsImdldFJhbmRvbVVuaXF1ZU51bWJlciIsInJlbW92ZUFuc3dlckNhcmRzIiwi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bENnQyxVQUFVOUMsUUFBUSxFQUNsQitDLFFBQVF0QyxLQUFLLEVBQ2JSLElBQUl1RCxLQUFLL0MsS0FBSyxFQUNkZixZQUFZd0QsU0FBVyxDQUFBLEVBQ3ZCM0QsWUFBWTJELFNBQVcsQ0FBQSxFQUN2QkwsU0FBU0ssU0FBVyxDQUFBLENBQ3JCLENBQUMsRUFFRDFELFFBQVFzQixpQkFBaUIsUUFBUyxXQUNqQzJDLFNBQVNoRCxLQUFLLEVBQ2RBLE1BQVE0QyxzQkFBc0JwRCxHQUFHLEVBQ2pDSSxRQUFRMEIsSUFBSXRCLEtBQUssRUFDakJzQyxRQUFRdEMsS0FBSyxFQUNiNkMsa0JBQWlCLENBQ2xCLENBQUMsRUFFRDdELE9BQU9xQixpQkFBaUIsUUFBUyxXQUNoQ3lDLFlBQVk5QyxLQUFLLEVBRWpCc0MsUUFEQXRDLE1BQVE0QyxzQkFBc0JwRCxHQUFHLENBQ3BCLEVBQ2JxRCxrQkFBaUIsQ0FDbEIsQ0FBQyIsImZpbGUiOiJmZXRjaERhdGEuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBjYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhbnZhc1wiKTtcclxuY29uc3QgY3R4ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiLCB7IHdpbGxSZWFkRnJlcXVlbnRseTogdHJ1ZSB9KTtcclxuY29uc3QgdGFza0NvbnRlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbnRlbnRcIik7XHJcbmNvbnN0IGFuc3dlckNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFwiLm1haW5EcmF3X2NvbnRhaW5lci1jYXJkcy1jb250YWluZXItYW5zd2VyLWJvYXJkXCJcclxuKTtcclxuY29uc3QgY2hlY2tBbnN3ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNoZWNrLWFuc3dlclwiKTtcclxuY29uc3QgcmVzdWx0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZXN1bHRcIik7XHJcbmNvbnN0IGdvb2RCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmdvb2QtYW5zd2VyXCIpO1xyXG5jb25zdCBiYWRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLndyb25nLWFuc3dlclwiKTtcclxuY29uc3Qgc3RhcnRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnN0YXJ0LXBsYXlcIik7XHJcbmNvbnN0IGFuc3dlckJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmJ1dHRvbi1hbnN3ZXJcIik7XHJcbmNvbnN0IGNsZWFyQ2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jbGVhci1jYW52YXNcIik7XHJcbmNvbnN0IGRyYXdpbmdDYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuXHRcIi5tYWluRHJhd19jb250YWluZXItY2FyZHMtY29udGFpbmVyLWRyYXdpbmctYm9hcmRcIlxyXG4pO1xyXG5jb25zdCByZXN1bHRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucmVzdWx0UG9wdXBcIik7XHJcbmNvbnN0IHVybFBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMod2luZG93LmxvY2F0aW9uLnNlYXJjaCk7XHJcbmNvbnN0IGdhbWVUeXBlID0gdXJsUGFyYW1zLmdldChcImdhbWVcIik7XHJcblxyXG5jb25zdCBhcnIgPSBbXTtcclxubGV0IHBvaW50cyA9IDA7XHJcbmxldCBpbmRleCA9IDA7XHJcblxyXG5pbXBvcnQgeyBpbml0aWFsaXplQXBwIH0gZnJvbSBcImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tL2ZpcmViYXNlanMvOS4xNy4xL2ZpcmViYXNlLWFwcC5qc1wiO1xyXG5pbXBvcnQge1xyXG5cdGdldERhdGFiYXNlLFxyXG5cdHJlZixcclxuXHRjaGlsZCxcclxuXHRnZXQsXHJcbn0gZnJvbSBcImh0dHBzOi8vd3d3LmdzdGF0aWMuY29tL2ZpcmViYXNlanMvOS4xNy4xL2ZpcmViYXNlLWRhdGFiYXNlLmpzXCI7XHJcblxyXG5jb25zdCBhcHAgPSBpbml0aWFsaXplQXBwKGZpcmViYXNlQ29uZmlnKTtcclxuXHJcbmNvbnN0IGRhdGFiYXNlID0gZ2V0RGF0YWJhc2UoYXBwKTtcclxuXHJcbmZ1bmN0aW9uIHNldEJhY2tncm91bmQoaW5kZXgpIHtcclxuXHRjb25zdCBiYWNrZ3JvdW5kSW1hZ2UgPSBuZXcgSW1hZ2UoKTtcclxuXHRjb25zdCBkYXRhUmVmID0gcmVmKGdldERhdGFiYXNlKCkpO1xyXG5cdGdldChjaGlsZChkYXRhUmVmLCBgZXhlcmNpc2UvJHtpbmRleH1gKSlcclxuXHRcdC50aGVuKChzbmFwc2hvdCkgPT4ge1xyXG5cdFx0XHRpZiAoc25hcHNob3QuZXhpc3RzKCkpIHtcclxuXHRcdFx0XHRjb25zdCBkYXRhID0gc25hcHNob3QudmFsKCk7XHJcblx0XHRcdFx0YmFja2dyb3VuZEltYWdlLnNyYyA9IGRhdGEuejtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIm5vIGRhdGEgYXZhaWxhYmxlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKChlcnJvcikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcclxuXHRcdH0pO1xyXG5cclxuXHRiYWNrZ3JvdW5kSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgKCkgPT4ge1xyXG5cdFx0Y3R4LmRyYXdJbWFnZShiYWNrZ3JvdW5kSW1hZ2UsIDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XHJcblx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFRhc2tDb250ZW50KGluZGV4KSB7XHJcblx0Y29uc3QgZGF0YVJlZiA9IHJlZihnZXREYXRhYmFzZSgpKTtcclxuXHRnZXQoY2hpbGQoZGF0YVJlZiwgYGV4ZXJjaXNlLyR7aW5kZXh9YCkpXHJcblx0XHQudGhlbigoc25hcHNob3QpID0+IHtcclxuXHRcdFx0aWYgKHNuYXBzaG90LmV4aXN0cygpKSB7XHJcblx0XHRcdFx0Y29uc3QgZGF0YSA9IHNuYXBzaG90LnZhbCgpO1xyXG5cdFx0XHRcdHRhc2tDb250ZW50LnRleHRDb250ZW50ID0gZGF0YS50O1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldEFuc3dlcihpbmRleCkge1xyXG5cdGNvbnN0IGRhdGFSZWYgPSByZWYoZ2V0RGF0YWJhc2UoKSk7XHJcblx0Z2V0KGNoaWxkKGRhdGFSZWYsIGBleGVyY2lzZS8ke2luZGV4fWApKVxyXG5cdFx0LnRoZW4oKHNuYXBzaG90KSA9PiB7XHJcblx0XHRcdGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBzbmFwc2hvdC52YWwoKTtcclxuXHRcdFx0XHRhbnN3ZXJDYXJkLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9IGB1cmwoJyR7ZGF0YS5vfScpYDtcclxuXHRcdFx0XHRhbnN3ZXJDYXJkLnN0eWxlLmJhY2tncm91bmRTaXplID0gXCJjb250YWluXCI7XHJcblx0XHRcdFx0YW5zd2VyQ2FyZC5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb24gPSBcImNlbnRlclwiO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFBvaW50KGluZGV4KSB7XHJcblx0Y29uc3QgZGF0YVJlZiA9IHJlZihnZXREYXRhYmFzZSgpKTtcclxuXHRnZXQoY2hpbGQoZGF0YVJlZiwgYGV4ZXJjaXNlLyR7aW5kZXh9YCkpXHJcblx0XHQudGhlbigoc25hcHNob3QpID0+IHtcclxuXHRcdFx0aWYgKHNuYXBzaG90LmV4aXN0cygpKSB7XHJcblx0XHRcdFx0Y29uc3QgZGF0YSA9IHNuYXBzaG90LnZhbCgpO1xyXG5cdFx0XHRcdHBvaW50cyArPSBkYXRhLnA7XHJcblx0XHRcdFx0cmVzdWx0LnRleHRDb250ZW50ID0gcG9pbnRzO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcblxyXG5cdHJlc3VsdC5jbGFzc0xpc3QuYWRkKFwiYWRkUG9pbnRcIik7XHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRyZXN1bHQuY2xhc3NMaXN0LnJlbW92ZShcImFkZFBvaW50XCIpO1xyXG5cdH0sIDEwMDApO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVQb2ludChpbmRleCkge1xyXG5cdGNvbnN0IGRhdGFSZWYgPSByZWYoZ2V0RGF0YWJhc2UoKSk7XHJcblx0Z2V0KGNoaWxkKGRhdGFSZWYsIGBleGVyY2lzZS8ke2luZGV4fWApKVxyXG5cdFx0LnRoZW4oKHNuYXBzaG90KSA9PiB7XHJcblx0XHRcdGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBzbmFwc2hvdC52YWwoKTtcclxuXHRcdFx0XHRwb2ludHMgLT0gZGF0YS5wO1xyXG5cdFx0XHRcdHJlc3VsdC50ZXh0Q29udGVudCA9IHBvaW50cztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIm5vIGRhdGEgYXZhaWxhYmxlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKChlcnJvcikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcclxuXHRcdH0pO1xyXG5cclxuXHRyZXN1bHQuY2xhc3NMaXN0LmFkZChcInJlbW92ZVBvaW50XCIpO1xyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0cmVzdWx0LmNsYXNzTGlzdC5yZW1vdmUoXCJyZW1vdmVQb2ludFwiKTtcclxuXHR9LCAxMDAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0RGF0YShpbmRleCkge1xyXG5cdHNldEJhY2tncm91bmQoaW5kZXgpO1xyXG5cdHNldFRhc2tDb250ZW50KGluZGV4KTtcclxuXHRzZXRBbnN3ZXIoaW5kZXgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVBbnN3ZXJDYXJkcygpIHtcclxuXHRhbnN3ZXJDYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJhLWFjdGl2ZVwiKTtcclxuXHRkcmF3aW5nQ2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiZC1hY3RpdmVcIik7XHJcblx0YW5zd2VyQnRucy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJiLWFjdGl2ZVwiKTtcclxuXHR9KTtcclxufVxyXG5cclxuY29uc3QgcmFuZFVuaXF1ZU51bWJlciA9IChtaW4sIG1heCkgPT4ge1xyXG5cdGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcclxuXHRyZXR1cm4gaW5kZXg7XHJcbn07XHJcblxyXG5jb25zdCBmZXRjaERhdGEgPSAoZ2FtZVR5cGUpID0+IHtcclxuXHRpZiAoZ2FtZVR5cGUgPT09IFwiZmxhdFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMSwgMTYpO1xyXG5cdH0gZWxzZSBpZiAoZ2FtZVR5cGUgPT09IFwic3BhdGlhbFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMjIsIDE2MCk7XHJcblx0fSBlbHNlIGlmIChnYW1lVHlwZSA9PT0gXCJtaXhcIikge1xyXG5cdFx0aW5kZXggPSByYW5kVW5pcXVlTnVtYmVyKDEwMCwgMTYwKTtcclxuXHR9XHJcblx0Y29uc29sZS5sb2coaW5kZXgpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gZ2V0UmFuZG9tVW5pcXVlTnVtYmVyKGFycikge1xyXG5cdGZldGNoRGF0YShnYW1lVHlwZSk7XHJcblx0d2hpbGUgKGFyci5pbmNsdWRlcyhpbmRleCkpIHtcclxuXHRcdGZldGNoRGF0YShnYW1lVHlwZSk7XHJcblx0fVxyXG5cdGFyci5wdXNoKGluZGV4KTtcclxuXHRyZXR1cm4gaW5kZXg7XHJcbn1cclxuXHJcbmNsZWFyQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcblx0c2V0RGF0YShpbmRleCk7XHJcbn0pO1xyXG5cclxuc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuXHRmZXRjaERhdGEoZ2FtZVR5cGUpO1xyXG5cdHNldERhdGEoaW5kZXgpO1xyXG5cdGFyci5wdXNoKGluZGV4KTtcclxuXHRjbGVhckNhbnZhcy5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cdGNoZWNrQW5zd2VyLmRpc2FibGVkID0gZmFsc2U7XHJcblx0c3RhcnRCdG4uZGlzYWJsZWQgPSB0cnVlO1xyXG59KTtcclxuXHJcbmdvb2RCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuXHRhZGRQb2ludChpbmRleCk7XHJcblx0aW5kZXggPSBnZXRSYW5kb21VbmlxdWVOdW1iZXIoYXJyKTtcclxuXHRjb25zb2xlLmxvZyhpbmRleCk7XHJcblx0c2V0RGF0YShpbmRleCk7XHJcblx0cmVtb3ZlQW5zd2VyQ2FyZHMoKTtcclxufSk7XHJcblxyXG5iYWRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuXHRyZW1vdmVQb2ludChpbmRleCk7XHJcblx0aW5kZXggPSBnZXRSYW5kb21VbmlxdWVOdW1iZXIoYXJyKTtcclxuXHRzZXREYXRhKGluZGV4KTtcclxuXHRyZW1vdmVBbnN3ZXJDYXJkcygpO1xyXG59KTtcclxuIl19
