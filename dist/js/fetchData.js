"use strict";var _firebaseApp=require("https://www.gstatic.com/firebasejs/9.17.1/firebase-app.js"),_firebaseDatabase=require("https://www.gstatic.com/firebasejs/9.17.1/firebase-database.js"),canvas=document.querySelector(".canvas"),ctx=canvas.getContext("2d",{willReadFrequently:!0}),taskContent=document.querySelector(".content"),answerCard=document.querySelector(".mainDraw_container-cards-container-answer-board"),checkAnswer=document.querySelector(".check-answer"),result=document.querySelector(".result"),goodBtn=document.querySelector(".good-answer"),badBtn=document.querySelector(".wrong-answer"),startBtn=document.querySelector(".start-play"),answerBtns=document.querySelectorAll(".button-answer"),clearCanvas=document.querySelector(".clear-canvas"),drawingCard=document.querySelector(".mainDraw_container-cards-container-drawing-board"),userPoints=document.querySelector(".points"),nextBtn=document.querySelector(".next"),resultPopup=document.querySelector(".resultPopup"),urlParams=new URLSearchParams(window.location.search),gameType=urlParams.get("game"),arr=[],points=0,index=0,app=(0,_firebaseApp.initializeApp)(firebaseConfig),database=(0,_firebaseDatabase.getDatabase)(app);function setBackground(e){var s=new Image,a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),s.src=e.z):console.log("no data available")}).catch(function(e){console.error(e)}),s.addEventListener("load",function(){var e=s.width/s.height,a=canvas.width,t=canvas.height,e=(a/e<t?t=a/e:a=t*e,(canvas.width-a)/2),n=(canvas.height-t)/2;ctx.drawImage(s,e,n,a,t)})}function setTaskContent(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),taskContent.textContent=e.t):console.log("no data available")}).catch(function(e){console.error(e)})}function setAnswer(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),answerCard.style.backgroundImage="url('".concat(e.o,"')"),answerCard.style.backgroundSize="contain",answerCard.style.backgroundPosition="center",answerCard.style.backgroundRepeat="no-repeat"):console.log("no data available")}).catch(function(e){console.error(e)})}function addPoint(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),points+=e.p,result.textContent=points):console.log("no data available")}).catch(function(e){console.error(e)}),result.classList.add("addPoint"),setTimeout(function(){result.classList.remove("addPoint")},1e3)}function removePoint(e){var a=(0,_firebaseDatabase.ref)((0,_firebaseDatabase.getDatabase)());(0,_firebaseDatabase.get)((0,_firebaseDatabase.child)(a,"exercise/".concat(e))).then(function(e){e.exists()?(e=e.val(),points-=e.p,result.textContent=points):console.log("no data available")}).catch(function(e){console.error(e)}),result.classList.add("removePoint"),setTimeout(function(){result.classList.remove("removePoint")},1e3)}function setData(e){setBackground(e),setTaskContent(e),setAnswer(e)}function removeAnswerCards(){answerCard.classList.remove("a-active"),drawingCard.classList.remove("d-active"),answerBtns.forEach(function(e){e.classList.remove("b-active")})}var randUniqueNumber=function(e,a){return Math.floor(Math.random()*(a-e+1))+e},fetchData=function(e){"flat"===e?index=randUniqueNumber(1,23):"spatial"===e?index=randUniqueNumber(24,41):"mix"!==e&&"teacher"!==e||(index=randUniqueNumber(1,41)),console.log(index)};function getRandomUniqueNumber(e){for(fetchData(gameType);e.includes(index);)fetchData(gameType);return e.push(index),index}"teacher"===gameType&&(nextBtn.style.display="block",checkAnswer.style.display="none",goodBtn.style.display="none",badBtn.style.display="none",userPoints.style.display="none",resultPopup.style.display="none",document.querySelector(".downloadFile").style.display="block",document.querySelector(".textPopup").textContent="Pobierz plik z odpowiedziami"),nextBtn.addEventListener("click",function(){setData(index=getRandomUniqueNumber(arr))}),clearCanvas.addEventListener("click",function(){setData(index)}),startBtn.addEventListener("click",function(){fetchData(gameType),setData(index),arr.push(index),clearCanvas.disabled=!1,checkAnswer.disabled=!1,nextBtn.disabled=!1,startBtn.disabled=!0}),goodBtn.addEventListener("click",function(){addPoint(index),index=getRandomUniqueNumber(arr),console.log(index),setData(index),removeAnswerCards(),window.scrollTo(0,0)}),badBtn.addEventListener("click",function(){removePoint(index),setData(index=getRandomUniqueNumber(arr)),removeAnswerCards(),window.scrollTo(0,0)});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZldGNoRGF0YS5qcyJdLCJuYW1lcyI6WyJfZmlyZWJhc2VBcHAiLCJyZXF1aXJlIiwiX2ZpcmViYXNlRGF0YWJhc2UiLCJjYW52YXMiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjdHgiLCJnZXRDb250ZXh0Iiwid2lsbFJlYWRGcmVxdWVudGx5IiwidGFza0NvbnRlbnQiLCJhbnN3ZXJDYXJkIiwicmVzdWx0IiwiY2hlY2tBbnN3ZXIiLCJnb29kQnRuIiwiYmFkQnRuIiwiY2xlYXJDYW52YXMiLCJkcmF3aW5nQ2FyZCIsInVzZXJQb2ludHMiLCJuZXh0QnRuIiwiVVJMU2VhcmNoUGFyYW1zIiwid2luZG93IiwibG9jYXRpb24iLCJzZWFyY2giLCJyZXN1bHRQb3B1cCIsInVybFBhcmFtcyIsImdhbWVUeXBlIiwiYXJyIiwicG9pbnRzIiwiYmFja2dyb3VuZEltYWdlIiwiZmlyZWJhc2VDb25maWciLCJjb25zb2xlIiwiZ2V0RGF0YWJhc2UiLCJhcHAiLCJzZXRCYWNrZ3JvdW5kIiwiaW5kZXgiLCJJbWFnZSIsImRhdGFSZWYiLCJyZWYiLCJnZXQiLCJhZGRFdmVudExpc3RlbmVyIiwidGhlbiIsImFzcGVjdFJhdGlvIiwic25hcHNob3QiLCJoZWlnaHQiLCJsb2ciLCJlcnJvciIsInNldFRhc2tDb250ZW50Iiwid2lkdGgiLCJ4IiwiZGF0YSIsImRyYXdJbWFnZSIsInkiLCJjaGlsZCIsInN0eWxlIiwiZXhpc3RzIiwiYmFja2dyb3VuZFJlcGVhdCIsInRleHRDb250ZW50IiwidCIsInZhbCIsImNvbmNhdCIsIm8iLCJiYWNrZ3JvdW5kU2l6ZSIsInNldFRpbWVvdXQiLCJyZW1vdmVQb2ludCIsImFkZFBvaW50IiwicCIsImNsYXNzTGlzdCIsInJlbW92ZSIsImFuc3dlckJ0bnMiLCJlbGVtZW50IiwicmFuZFVuaXF1ZU51bWJlciIsIk1hdGgiLCJnZXRSYW5kb21VbmlxdWVOdW1iZXIiLCJmZXRjaERhdGEiLCJzZXREYXRhIiwic2V0QW5zd2VyIiwiZGlzcGxheSIsImZvckVhY2giLCJtaW4iLCJtYXgiLCJyYW5kb20iLCJzdGFydEJ0biIsImRpc2FibGVkIiwicmVtb3ZlQW5zd2VyQ2FyZHMiLCJzY3JvbGxUbyIsInB1c2giXSwibWFwcGluZ3MiOiJhQWtDQSxJQUFBQSxhQUFBQyxRQUFBLDJEQUFBLEVBRUFDLGtCQUFBRCxRQUFBLGdFQUFBLEVBcENNRSxPQUFTQyxTQUFTQyxjQUFjLFNBQVMsRUFDekNDLElBQU1ILE9BQU9JLFdBQVcsS0FBTSxDQUFFQyxtQkFBb0IsQ0FBQSxDQUFLLENBQUMsRUF5QmhFQyxZQUFBTCxTQUFBQyxjQUFBLFVBQUEsRUFDQUssV0FBQU4sU0FBQUMsY0EzQkEsa0RBQWdELEVBQ1ZHLFlBQWtCSixTQUFFQyxjQUFBLGVBQUEsRUFBT00sT0FBQVAsU0FBQUMsY0FBQSxTQUFBLEVBQzNESSxRQUFXTCxTQUFHQSxjQUFTQyxjQUF5QixFQUNoREssT0FBVU4sU0FBR0EsY0FBU0MsZUFDM0IsRUFFS08sU0FBV1IsU0FBV0MsY0FBYyxhQUFDLEVBQ3JDTSxXQUFTUCxTQUFTQyxpQkFBdUIsZ0JBQUMsRUFDMUNRLFlBQVVULFNBQVNDLGNBQWMsZUFBZSxFQUNoRFMsWUFBU1YsU0FBU0MsY0FDeEIsbURBQXNELEVBRWhEVSxXQUFjWCxTQUFTQyxjQUFjLFNBQUEsRUFDckNXLFFBQVdaLFNBQUdBLGNBQVNDLE9BQzVCLEVBRUtZLFlBQWFiLFNBQVNDLGNBQWMsY0FBVSxFQUM5Q2EsVUFBVWQsSUFBUWUsZ0JBQWVDLE9BQVFDLFNBQUFDLE1BQUEsRUFDekNDLFNBQVdDLFVBQVluQixJQUFBQSxNQUFBQSxFQUV2Qm9CLElBQVEsR0FFUkMsT0FBUSxFQUNWQyxNQUFNLEVBc0JOQyxLQUFBQSxFQUFBQSxhQUFBQSxlQUFtQkMsY0FBUyxFQUU1QkMsVUFBVyxFQUFBQyxrQkFBQUEsYUFBQ0MsR0FBQSxFQVRoQixTQVdJQyxjQUNLQyxHQVhSLElBWUVKLEVBQW9CLElBQUFLLE1BQ25CQyxHQUFBLEVBQUFDLGtCQUFBQSxNQUFBLEVB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QUFRc0Msc0JBQXNCOUMsR0FBRyxFQUNqQ0ksUUFBUWMsSUFBSVYsS0FBSyxFQUNqQndDLFFBQVF4QyxLQUFLLEVBQ2JpRCxrQkFBaUIsRUFDakIvRCxPQUFPZ0UsU0FBUyxFQUFHLENBQUMsQ0FDckIsQ0FBQyxFQUVEdEUsT0FBT3lCLGlCQUFpQixRQUFTLFdBQ2hDd0IsWUFBWTdCLEtBQUssRUFFakJ3QyxRQURBeEMsTUFBUXNDLHNCQUFzQjlDLEdBQUcsQ0FDcEIsRUFDYnlELGtCQUFpQixFQUNqQi9ELE9BQU9nRSxTQUFTLEVBQUcsQ0FBQyxDQUNyQixDQUFDIiwiZmlsZSI6ImZldGNoRGF0YS5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FudmFzXCIpO1xyXG5jb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dChcIjJkXCIsIHsgd2lsbFJlYWRGcmVxdWVudGx5OiB0cnVlIH0pO1xyXG5jb25zdCB0YXNrQ29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29udGVudFwiKTtcclxuY29uc3QgYW5zd2VyQ2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcblx0XCIubWFpbkRyYXdfY29udGFpbmVyLWNhcmRzLWNvbnRhaW5lci1hbnN3ZXItYm9hcmRcIlxyXG4pO1xyXG5jb25zdCBjaGVja0Fuc3dlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2hlY2stYW5zd2VyXCIpO1xyXG5jb25zdCByZXN1bHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc3VsdFwiKTtcclxuY29uc3QgZ29vZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ29vZC1hbnN3ZXJcIik7XHJcbmNvbnN0IGJhZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIud3JvbmctYW5zd2VyXCIpO1xyXG5jb25zdCBzdGFydEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuc3RhcnQtcGxheVwiKTtcclxuY29uc3QgYW5zd2VyQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuYnV0dG9uLWFuc3dlclwiKTtcclxuY29uc3QgY2xlYXJDYW52YXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNsZWFyLWNhbnZhc1wiKTtcclxuY29uc3QgZHJhd2luZ0NhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG5cdFwiLm1haW5EcmF3X2NvbnRhaW5lci1jYXJkcy1jb250YWluZXItZHJhd2luZy1ib2FyZFwiXHJcbik7XHJcbmNvbnN0IHVzZXJQb2ludHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvaW50c1wiKTtcclxuY29uc3QgbmV4dEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubmV4dFwiKTtcclxuY29uc3QgcmVzdWx0UG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnJlc3VsdFBvcHVwXCIpO1xyXG5jb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHdpbmRvdy5sb2NhdGlvbi5zZWFyY2gpO1xyXG5jb25zdCBnYW1lVHlwZSA9IHVybFBhcmFtcy5nZXQoXCJnYW1lXCIpO1xyXG5cclxuY29uc3QgYXJyID0gW107XHJcbmxldCBwb2ludHMgPSAwO1xyXG5sZXQgaW5kZXggPSAwO1xyXG5cclxuaW1wb3J0IHsgaW5pdGlhbGl6ZUFwcCB9IGZyb20gXCJodHRwczovL3d3dy5nc3RhdGljLmNvbS9maXJlYmFzZWpzLzkuMTcuMS9maXJlYmFzZS1hcHAuanNcIjtcclxuaW1wb3J0IHtcclxuXHRnZXREYXRhYmFzZSxcclxuXHRyZWYsXHJcblx0Y2hpbGQsXHJcblx0Z2V0LFxyXG59IGZyb20gXCJodHRwczovL3d3dy5nc3RhdGljLmNvbS9maXJlYmFzZWpzLzkuMTcuMS9maXJlYmFzZS1kYXRhYmFzZS5qc1wiO1xyXG5cclxuY29uc3QgYXBwID0gaW5pdGlhbGl6ZUFwcChmaXJlYmFzZUNvbmZpZyk7XHJcblxyXG5jb25zdCBkYXRhYmFzZSA9IGdldERhdGFiYXNlKGFwcCk7XHJcblxyXG5mdW5jdGlvbiBzZXRCYWNrZ3JvdW5kKGluZGV4KSB7XHJcblx0Y29uc3QgYmFja2dyb3VuZEltYWdlID0gbmV3IEltYWdlKCk7XHJcblx0Y29uc3QgZGF0YVJlZiA9IHJlZihnZXREYXRhYmFzZSgpKTtcclxuXHRnZXQoY2hpbGQoZGF0YVJlZiwgYGV4ZXJjaXNlLyR7aW5kZXh9YCkpXHJcblx0XHQudGhlbigoc25hcHNob3QpID0+IHtcclxuXHRcdFx0aWYgKHNuYXBzaG90LmV4aXN0cygpKSB7XHJcblx0XHRcdFx0Y29uc3QgZGF0YSA9IHNuYXBzaG90LnZhbCgpO1xyXG5cdFx0XHRcdGJhY2tncm91bmRJbWFnZS5zcmMgPSBkYXRhLno7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJubyBkYXRhIGF2YWlsYWJsZVwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHRcdC5jYXRjaCgoZXJyb3IpID0+IHtcclxuXHRcdFx0Y29uc29sZS5lcnJvcihlcnJvcik7XHJcblx0XHR9KTtcclxuXHJcblx0YmFja2dyb3VuZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpID0+IHtcclxuXHRcdGNvbnN0IGFzcGVjdFJhdGlvID0gYmFja2dyb3VuZEltYWdlLndpZHRoIC8gYmFja2dyb3VuZEltYWdlLmhlaWdodDtcclxuXHRcdGxldCB3aWR0aCA9IGNhbnZhcy53aWR0aDtcclxuXHRcdGxldCBoZWlnaHQgPSBjYW52YXMuaGVpZ2h0O1xyXG5cdFx0aWYgKHdpZHRoIC8gYXNwZWN0UmF0aW8gPCBoZWlnaHQpIHtcclxuXHRcdFx0aGVpZ2h0ID0gd2lkdGggLyBhc3BlY3RSYXRpbztcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHdpZHRoID0gaGVpZ2h0ICogYXNwZWN0UmF0aW87XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgeCA9IChjYW52YXMud2lkdGggLSB3aWR0aCkgLyAyO1xyXG5cdFx0Y29uc3QgeSA9IChjYW52YXMuaGVpZ2h0IC0gaGVpZ2h0KSAvIDI7XHJcblxyXG5cdFx0Y3R4LmRyYXdJbWFnZShiYWNrZ3JvdW5kSW1hZ2UsIHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG5cdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRUYXNrQ29udGVudChpbmRleCkge1xyXG5cdGNvbnN0IGRhdGFSZWYgPSByZWYoZ2V0RGF0YWJhc2UoKSk7XHJcblx0Z2V0KGNoaWxkKGRhdGFSZWYsIGBleGVyY2lzZS8ke2luZGV4fWApKVxyXG5cdFx0LnRoZW4oKHNuYXBzaG90KSA9PiB7XHJcblx0XHRcdGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBzbmFwc2hvdC52YWwoKTtcclxuXHRcdFx0XHR0YXNrQ29udGVudC50ZXh0Q29udGVudCA9IGRhdGEudDtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIm5vIGRhdGEgYXZhaWxhYmxlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKChlcnJvcikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcclxuXHRcdH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzZXRBbnN3ZXIoaW5kZXgpIHtcclxuXHRjb25zdCBkYXRhUmVmID0gcmVmKGdldERhdGFiYXNlKCkpO1xyXG5cdGdldChjaGlsZChkYXRhUmVmLCBgZXhlcmNpc2UvJHtpbmRleH1gKSlcclxuXHRcdC50aGVuKChzbmFwc2hvdCkgPT4ge1xyXG5cdFx0XHRpZiAoc25hcHNob3QuZXhpc3RzKCkpIHtcclxuXHRcdFx0XHRjb25zdCBkYXRhID0gc25hcHNob3QudmFsKCk7XHJcblx0XHRcdFx0YW5zd2VyQ2FyZC5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCcke2RhdGEub30nKWA7XHJcblx0XHRcdFx0YW5zd2VyQ2FyZC5zdHlsZS5iYWNrZ3JvdW5kU2l6ZSA9IFwiY29udGFpblwiO1xyXG5cdFx0XHRcdGFuc3dlckNhcmQuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uID0gXCJjZW50ZXJcIjtcclxuXHRcdFx0XHRhbnN3ZXJDYXJkLnN0eWxlLmJhY2tncm91bmRSZXBlYXQgPSBcIm5vLXJlcGVhdFwiO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGFkZFBvaW50KGluZGV4KSB7XHJcblx0Y29uc3QgZGF0YVJlZiA9IHJlZihnZXREYXRhYmFzZSgpKTtcclxuXHRnZXQoY2hpbGQoZGF0YVJlZiwgYGV4ZXJjaXNlLyR7aW5kZXh9YCkpXHJcblx0XHQudGhlbigoc25hcHNob3QpID0+IHtcclxuXHRcdFx0aWYgKHNuYXBzaG90LmV4aXN0cygpKSB7XHJcblx0XHRcdFx0Y29uc3QgZGF0YSA9IHNuYXBzaG90LnZhbCgpO1xyXG5cdFx0XHRcdHBvaW50cyArPSBkYXRhLnA7XHJcblx0XHRcdFx0cmVzdWx0LnRleHRDb250ZW50ID0gcG9pbnRzO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKFwibm8gZGF0YSBhdmFpbGFibGVcIik7XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goKGVycm9yKSA9PiB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG5cdFx0fSk7XHJcblxyXG5cdHJlc3VsdC5jbGFzc0xpc3QuYWRkKFwiYWRkUG9pbnRcIik7XHJcblx0c2V0VGltZW91dCgoKSA9PiB7XHJcblx0XHRyZXN1bHQuY2xhc3NMaXN0LnJlbW92ZShcImFkZFBvaW50XCIpO1xyXG5cdH0sIDEwMDApO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVQb2ludChpbmRleCkge1xyXG5cdGNvbnN0IGRhdGFSZWYgPSByZWYoZ2V0RGF0YWJhc2UoKSk7XHJcblx0Z2V0KGNoaWxkKGRhdGFSZWYsIGBleGVyY2lzZS8ke2luZGV4fWApKVxyXG5cdFx0LnRoZW4oKHNuYXBzaG90KSA9PiB7XHJcblx0XHRcdGlmIChzbmFwc2hvdC5leGlzdHMoKSkge1xyXG5cdFx0XHRcdGNvbnN0IGRhdGEgPSBzbmFwc2hvdC52YWwoKTtcclxuXHRcdFx0XHRwb2ludHMgLT0gZGF0YS5wO1xyXG5cdFx0XHRcdHJlc3VsdC50ZXh0Q29udGVudCA9IHBvaW50cztcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcIm5vIGRhdGEgYXZhaWxhYmxlXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cdFx0LmNhdGNoKChlcnJvcikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmVycm9yKGVycm9yKTtcclxuXHRcdH0pO1xyXG5cclxuXHRyZXN1bHQuY2xhc3NMaXN0LmFkZChcInJlbW92ZVBvaW50XCIpO1xyXG5cdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0cmVzdWx0LmNsYXNzTGlzdC5yZW1vdmUoXCJyZW1vdmVQb2ludFwiKTtcclxuXHR9LCAxMDAwKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0RGF0YShpbmRleCkge1xyXG5cdHNldEJhY2tncm91bmQoaW5kZXgpO1xyXG5cdHNldFRhc2tDb250ZW50KGluZGV4KTtcclxuXHRzZXRBbnN3ZXIoaW5kZXgpO1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW1vdmVBbnN3ZXJDYXJkcygpIHtcclxuXHRhbnN3ZXJDYXJkLmNsYXNzTGlzdC5yZW1vdmUoXCJhLWFjdGl2ZVwiKTtcclxuXHRkcmF3aW5nQ2FyZC5jbGFzc0xpc3QucmVtb3ZlKFwiZC1hY3RpdmVcIik7XHJcblx0YW5zd2VyQnRucy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XHJcblx0XHRlbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJiLWFjdGl2ZVwiKTtcclxuXHR9KTtcclxufVxyXG5cclxuY29uc3QgcmFuZFVuaXF1ZU51bWJlciA9IChtaW4sIG1heCkgPT4ge1xyXG5cdGNvbnN0IGluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKG1heCAtIG1pbiArIDEpKSArIG1pbjtcclxuXHRyZXR1cm4gaW5kZXg7XHJcbn07XHJcblxyXG5jb25zdCBmZXRjaERhdGEgPSAoZ2FtZVR5cGUpID0+IHtcclxuXHRpZiAoZ2FtZVR5cGUgPT09IFwiZmxhdFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMSwgMjMpO1xyXG5cdH0gZWxzZSBpZiAoZ2FtZVR5cGUgPT09IFwic3BhdGlhbFwiKSB7XHJcblx0XHRpbmRleCA9IHJhbmRVbmlxdWVOdW1iZXIoMjQsIDQxKTtcclxuXHR9IGVsc2UgaWYgKGdhbWVUeXBlID09PSBcIm1peFwiIHx8IGdhbWVUeXBlID09PSBcInRlYWNoZXJcIikge1xyXG5cdFx0aW5kZXggPSByYW5kVW5pcXVlTnVtYmVyKDEsIDQxKTtcclxuXHR9XHJcblx0Y29uc29sZS5sb2coaW5kZXgpO1xyXG59O1xyXG5cclxuZnVuY3Rpb24gZ2V0UmFuZG9tVW5pcXVlTnVtYmVyKGFycikge1xyXG5cdGZldGNoRGF0YShnYW1lVHlwZSk7XHJcblx0d2hpbGUgKGFyci5pbmNsdWRlcyhpbmRleCkpIHtcclxuXHRcdGZldGNoRGF0YShnYW1lVHlwZSk7XHJcblx0fVxyXG5cdGFyci5wdXNoKGluZGV4KTtcclxuXHRyZXR1cm4gaW5kZXg7XHJcbn1cclxuXHJcbmlmIChnYW1lVHlwZSA9PT0gXCJ0ZWFjaGVyXCIpIHtcclxuXHRuZXh0QnRuLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0Y2hlY2tBbnN3ZXIuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdGdvb2RCdG4uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdGJhZEJ0bi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0dXNlclBvaW50cy5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcblx0cmVzdWx0UG9wdXAuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG5cdGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZG93bmxvYWRGaWxlXCIpLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcblx0ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi50ZXh0UG9wdXBcIikudGV4dENvbnRlbnQgPVxyXG5cdFx0XCJQb2JpZXJ6IHBsaWsgeiBvZHBvd2llZHppYW1pXCI7XHJcbn1cclxuXHJcbm5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRpbmRleCA9IGdldFJhbmRvbVVuaXF1ZU51bWJlcihhcnIpO1xyXG5cdHNldERhdGEoaW5kZXgpO1xyXG59KTtcclxuXHJcbmNsZWFyQ2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcblx0c2V0RGF0YShpbmRleCk7XHJcbn0pO1xyXG5cclxuc3RhcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcclxuXHRmZXRjaERhdGEoZ2FtZVR5cGUpO1xyXG5cdHNldERhdGEoaW5kZXgpO1xyXG5cdGFyci5wdXNoKGluZGV4KTtcclxuXHRjbGVhckNhbnZhcy5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cdGNoZWNrQW5zd2VyLmRpc2FibGVkID0gZmFsc2U7XHJcblx0bmV4dEJ0bi5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cdHN0YXJ0QnRuLmRpc2FibGVkID0gdHJ1ZTtcclxufSk7XHJcblxyXG5nb29kQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XHJcblx0YWRkUG9pbnQoaW5kZXgpO1xyXG5cdGluZGV4ID0gZ2V0UmFuZG9tVW5pcXVlTnVtYmVyKGFycik7XHJcblx0Y29uc29sZS5sb2coaW5kZXgpO1xyXG5cdHNldERhdGEoaW5kZXgpO1xyXG5cdHJlbW92ZUFuc3dlckNhcmRzKCk7XHJcblx0d2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG59KTtcclxuXHJcbmJhZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG5cdHJlbW92ZVBvaW50KGluZGV4KTtcclxuXHRpbmRleCA9IGdldFJhbmRvbVVuaXF1ZU51bWJlcihhcnIpO1xyXG5cdHNldERhdGEoaW5kZXgpO1xyXG5cdHJlbW92ZUFuc3dlckNhcmRzKCk7XHJcblx0d2luZG93LnNjcm9sbFRvKDAsIDApO1xyXG59KTtcclxuIl19
